<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="en-nz"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Naive Bayes Classification" /><meta property="og:locale" content="en" /><meta name="description" content="This post details the development process for my submission to the Point-of-Interest Categorization competition on Kaggle." /><meta property="og:description" content="This post details the development process for my submission to the Point-of-Interest Categorization competition on Kaggle." /><link rel="canonical" href="https://chaserobertson.github.io/posts/naive-bayes/" /><meta property="og:url" content="https://chaserobertson.github.io/posts/naive-bayes/" /><meta property="og:site_name" content="Chase Robertson" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-06T00:00:00+12:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Naive Bayes Classification" /><meta name="twitter:site" content="@chase__rob" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-06T00:00:00+12:00","datePublished":"2022-05-06T00:00:00+12:00","description":"This post details the development process for my submission to the Point-of-Interest Categorization competition on Kaggle.","headline":"Naive Bayes Classification","mainEntityOfPage":{"@type":"WebPage","@id":"https://chaserobertson.github.io/posts/naive-bayes/"},"url":"https://chaserobertson.github.io/posts/naive-bayes/"}</script><title>Naive Bayes Classification | Chase Robertson</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Chase Robertson"><meta name="application-name" content="Chase Robertson"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/lib/fonts/main.css"><link rel="stylesheet" href="/assets/lib/bootstrap-4.6.1/bootstrap.min.css"><link rel="stylesheet" href="/assets/lib/fontawesome-free-5.15.4/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/magnific-popup-1.1.0/magnific-popup.css"> <script src="/assets/lib/jquery-3.6.0/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/me.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Chase Robertson</a></div><div class="site-subtitle font-italic">Data Scientist</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/Thesis/" class="nav-link"> <i class="fa-fw fas fa-bolt ml-xl-3 mr-xl-3 unloaded"></i> <span>THESIS</span> </a><li class="nav-item"> <a href="/Resume/" class="nav-link"> <i class="fa-fw fas fa-user ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a><li class="nav-item"> <a href="/CV/" class="nav-link"> <i class="fa-fw fas fa-address-card ml-xl-3 mr-xl-3 unloaded"></i> <span>CV</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/certifications/" class="nav-link"> <i class="fa-fw fas fa-certificate ml-xl-3 mr-xl-3 unloaded"></i> <span>CERTIFICATIONS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/chaserobertson" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/chase__rob" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['chaserobertson208','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/chase-robertson" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Naive Bayes Classification</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><h1 data-toc-skip>Naive Bayes Classification</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1651752000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> 6 May 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/chase__rob">Chase Robertson</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1409 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>This post details the development process for my submission to the <a href="https://www.kaggle.com/competitions/point-of-interest-categorization/overview">Point-of-Interest Categorization</a> competition on Kaggle.</p><h2 id="motivation"><span class="mr-2">Motivation</span><a href="#motivation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In order to match the benchmark model performance initially, some default parameters had to be modified straightaway. I chose to ignore prior probabilities in the Naive Bayesâ€™ probability calculation on suspicion that the training dataâ€™s category distribution was imbalanced. I also chose to tune the modelâ€™s smoothing parameter, as that seemed a necessary change to account for words with zero count. After making those two changes, I was able to closely match the benchmark modelâ€™s performance. Further improvement to prediction scores then needed to be achieved by other means.</p><h3 id="task-1"><span class="mr-2">Task 1</span><a href="#task-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I chose to first attempt to improve prediction by excluding english stop words from the word frequency vector. I also attempted to include bigrams in the vector, and tried turning off the default inverse document frequency calculation executed by the term frequency utility provided by <code class="language-plaintext highlighter-rouge">sklearn</code>. I also switched to the Rennie et al. (2003) version of Multinomial Naive Bayes model to try to address the issues illuminated in that paper.</p><h3 id="task-2"><span class="mr-2">Task 2</span><a href="#task-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I chose to add the <code class="language-plaintext highlighter-rouge">name</code> and <code class="language-plaintext highlighter-rouge">mean_checkin_time</code> attributes to the model to try to improve prediction scores. Some establishment names explicitly include class information, so the benefit of including that attribute is obvious. I chose to represent that attribute as a bag of words in the same or similar way as the <code class="language-plaintext highlighter-rouge">review</code> attribute. I suspected that information about the time spent checking in to the establishment may be helpful as well, as some categories may be associated with longer or shorter checkins. The only other attributes available in the dataset are latitude and longitude, which do not seem very informative since different types of businesses can be mixed in the same area. There could be some association between output class and location due to local tradition or zoning policy, but it would surely require some clever preprocessing for the Naive Bayes model to discover those associations.</p><h2 id="data-representation-and-preprocessing"><span class="mr-2">Data Representation and Preprocessing</span><a href="#data-representation-and-preprocessing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Each observation is initially represented by a term frequency vector, constructed from the <code class="language-plaintext highlighter-rouge">review</code> attribute. The default behavior of <code class="language-plaintext highlighter-rouge">sklearn</code>â€™s <code class="language-plaintext highlighter-rouge">TfidfTransformer</code> is to incorporate the inverse document frequency in each term frequency. In Task 1, that default behavior is turned off, so basic term frequency is used. English stop words are removed from the term frequency vector in both Task 1 and 2. Bigrams from the <code class="language-plaintext highlighter-rouge">review</code> feature are unsuccessfully included in Task 1, but somewhat successfully included in Task 2, with the difference in effect probably due to the additional maximum limit placed on the number of features in Task 2.</p><h2 id="implementation"><span class="mr-2">Implementation</span><a href="#implementation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Initial implementation focused on boilerplate setup and matching prediction performance with the benchmark level of about 87%. This was achieved by removing prior probabilities from prediction, and tuning the smoothing parameter.</p><h3 id="task-1-1"><span class="mr-2">Task 1</span><a href="#task-1-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Though many changes were attempted in Task 1, the real improvement in prediction came from the combination of removing english stop words and skipping the inverse document frequency calculation. These changes, in concert with the use of Rennie et al. (2003) model, led to a consistent prediction accuracy of almost 90%. I believe the removal of stop words and use of simpler term frequency vectors enabled the more robust <code class="language-plaintext highlighter-rouge">ComplementNB</code> model to resist bias to the training data.</p><h3 id="task-2-1"><span class="mr-2">Task 2</span><a href="#task-2-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Adding the <code class="language-plaintext highlighter-rouge">name</code> and <code class="language-plaintext highlighter-rouge">mean_checkin_time</code> attributes in Task 2 alone led to a small improvement in prediction accuracy. When considering the addition of more term frequency features, it occurred to me that there may be thousands of features already in the model that were not very informative. Adding the <code class="language-plaintext highlighter-rouge">max_features</code> argument to the Naive Bayes model, in combination with the additional attributes and re-tuning of existing hyperparameters, led to a significant improvement over the benchmark model.</p><h2 id="evaluation-procedure"><span class="mr-2">Evaluation Procedure</span><a href="#evaluation-procedure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>All models were evaluated and their hyperparameters selected by 5-fold cross-validation. I decided that cross-validation was necessary to maximize the number of observations available for training, since only a few thousand observations were available in total. Fewer cross-validation folds were used for intermediate exploration, as computation time of exhaustive grid search over many hyperparameters became an issue.</p><h2 id="validation-results"><span class="mr-2">Validation Results</span><a href="#validation-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The validation accuracy of each model is listed below. Again, this was calculated using 5-fold cross-validation to maximize the exposure of each model to the small training set.</p><ul><li>Task 0 (benchmark): <strong>88.5%</strong><li>Task 1 (optimised): <strong>89.4%</strong><li>Task 2 (additional attributes): <strong>91.4%</strong></ul><h1 id="code">Code</h1><h2 id="part-0a---setup"><span class="mr-2">Part 0a - Setup</span><a href="#part-0a---setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">ComplementNB</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345678</span><span class="p">)</span>

<span class="n">PATH_ROOT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">train_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'train.csv'</span><span class="p">)</span>
<span class="n">test_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'test.csv'</span><span class="p">)</span>
<span class="n">benchmark_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'benchmark_predict.csv'</span><span class="p">)</span>
<span class="n">improved_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'improved_predict.csv'</span><span class="p">)</span>
<span class="n">plus_attr_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'plus_attr_predict.csv'</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">train_file</span><span class="p">)</span>
<span class="n">X_train_review</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'category'</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
<span class="n">X_test_review</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'review'</span><span class="p">]</span>
<span class="n">X_test_id</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'ID'</span><span class="p">]</span>
</pre></table></code></div></div><h2 id="part-0b---replicate-benchmark-model"><span class="mr-2">Part 0b - Replicate Benchmark Model</span><a href="#part-0b---replicate-benchmark-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c1"># Replicate Benchmark Model
</span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'vect'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'tfidf'</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'clf'</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">()),</span>
<span class="p">])</span>

<span class="n">bench_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'clf__alpha'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">),</span>
    <span class="s">'clf__fit_prior'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">bench_cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">bench_params</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bench_model</span> <span class="o">=</span> <span class="n">bench_cv</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_review</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Best validation score: %r"</span> <span class="o">%</span> <span class="p">(</span><span class="n">bench_model</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"----- Achieved with -------"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">bench_params</span><span class="p">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"%s: %r"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bench_model</span><span class="p">.</span><span class="n">best_params_</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>Best validation score: 0.885144675049235
----- Achieved with -------
clf__alpha: 0.10000000000000003
clf__fit_prior: False
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># write predictions to file
</span><span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">bench_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_review</span><span class="p">),</span> 
                        <span class="n">name</span><span class="o">=</span><span class="s">'category'</span><span class="p">)</span>
<span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test_id</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">submission</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">benchmark_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="part-1---improve-based-on-review-only"><span class="mr-2">Part 1 - Improve based on Review only</span><a href="#part-1---improve-based-on-review-only" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1"># Improve Benchmark Model with complement model and new params
</span><span class="n">improved_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'vect'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'tfidf'</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
    <span class="c1"># IMPROVEMENT use model from Rennie et al. 2003
</span>    <span class="p">(</span><span class="s">'clf'</span><span class="p">,</span> <span class="n">ComplementNB</span><span class="p">()),</span>
<span class="p">])</span>

<span class="n">improved_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># IMPROVEMENT params 
</span>    <span class="s">'vect__stop_words'</span><span class="p">:</span> <span class="p">[</span><span class="s">'english'</span><span class="p">],</span>
    <span class="s">'vect__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
    <span class="s">'tfidf__use_idf'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
    <span class="c1"># BENCHMARK params
</span>    <span class="s">'clf__alpha'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="c1"># fit_prior unneccessary - only applies to edge cases in ComplementNB
</span><span class="p">}</span>

<span class="n">improved_cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">improved_pipe</span><span class="p">,</span> <span class="n">improved_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">improved_model</span> <span class="o">=</span> <span class="n">improved_cv</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_review</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Improvement over benchmark: %r"</span> <span class="o">%</span><span class="p">(</span><span class="n">improved_model</span><span class="p">.</span><span class="n">best_score_</span> <span class="o">-</span> <span class="n">bench_model</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Best validation score: %r"</span> <span class="o">%</span> <span class="p">(</span><span class="n">improved_model</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"----- Achieved with -------"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">improved_params</span><span class="p">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"%s: %r"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">improved_model</span><span class="p">.</span><span class="n">best_params_</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Improvement over benchmark: 0.008695046205120405
Best validation score: 0.8938397212543554
----- Achieved with -------
clf__alpha: 0.1
tfidf__use_idf: False
vect__ngram_range: (1, 1)
vect__stop_words: 'english'
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># write predictions to file
</span><span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">improved_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_review</span><span class="p">),</span> 
                        <span class="n">name</span><span class="o">=</span><span class="s">'category'</span><span class="p">)</span>
<span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test_id</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">submission</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">improved_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="part-2"><span class="mr-2">Part 2</span><a href="#part-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="c1"># Improve model with additional attributes
</span>
<span class="c1"># Add 'name' attr and use the same BoW preprocess as 'review'
</span><span class="n">words_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s">'review'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">]</span>
<span class="n">words_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'vect'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'tfidf'</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
<span class="p">])</span>

<span class="c1"># Add mean checkin time without any preprocessing
</span><span class="n">num_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s">'mean_checkin_time'</span><span class="p">]</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'review'</span><span class="p">,</span> <span class="n">words_pipe</span><span class="p">,</span> <span class="s">'review'</span><span class="p">),</span>
    <span class="p">(</span><span class="s">'name'</span><span class="p">,</span> <span class="n">words_pipe</span><span class="p">,</span> <span class="s">'name'</span><span class="p">),</span>
    <span class="p">(</span><span class="s">'num'</span><span class="p">,</span> <span class="s">'passthrough'</span><span class="p">,</span> <span class="n">num_attrs</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">best_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'pre'</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s">'clf'</span><span class="p">,</span> <span class="n">ComplementNB</span><span class="p">()),</span>
<span class="p">])</span>

<span class="n">best_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># TASK 2 IMPROVEMENT params
</span>    <span class="s">'pre__review__vect__max_features'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="c1"># TASK 1 IMPROVEMENT params
</span>    <span class="s">'pre__review__vect__stop_words'</span><span class="p">:</span> <span class="p">[</span><span class="s">'english'</span><span class="p">],</span> <span class="c1"># , None],
</span>    <span class="s">'pre__review__vect__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="c1">#, (1,1)],
</span>    <span class="c1">#'pre__name__vect__ngram_range': [(1,1), (1,2)],
</span>    <span class="c1">#'pre__review__tfidf__use_idf': [False], #, True],
</span>    <span class="s">'pre__name__tfidf__use_idf'</span><span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">],</span> <span class="c1">#, True],
</span>    <span class="c1"># BENCHMARK params
</span>    <span class="s">'clf__alpha'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">),</span> <span class="c1">#np.arange(0.3, 0.22, -0.02),
</span>    <span class="s">'clf__fit_prior'</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="c1">#, False],
</span><span class="p">}</span>

<span class="n">best_cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">best_pipe</span><span class="p">,</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">best_model</span> <span class="o">=</span> <span class="n">best_cv</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Improvement over benchmark: %r"</span> <span class="o">%</span><span class="p">(</span><span class="n">best_model</span><span class="p">.</span><span class="n">best_score_</span> <span class="o">-</span> <span class="n">bench_model</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Improvement over Part 1: %r"</span> <span class="o">%</span><span class="p">(</span><span class="n">best_model</span><span class="p">.</span><span class="n">best_score_</span> <span class="o">-</span> <span class="n">improved_model</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Best validation score: %r"</span> <span class="o">%</span> <span class="p">(</span><span class="n">best_model</span><span class="p">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"----- Achieved with -------"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">best_params</span><span class="p">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"%s: %r"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">best_model</span><span class="p">.</span><span class="n">best_params_</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Improvement over benchmark: 0.028885320405999004
Improvement over Part 1: 0.0201902742008786
Best validation score: 0.914029995455234
----- Achieved with -------
clf__alpha: 0.32
clf__fit_prior: True
pre__name__tfidf__use_idf: False
pre__review__vect__max_features: 3500
pre__review__vect__ngram_range: (1, 2)
pre__review__vect__stop_words: 'english'
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># write predictions to file
</span><span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">best_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> 
                        <span class="n">name</span><span class="o">=</span><span class="s">'category'</span><span class="p">)</span>
<span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test_id</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">submission</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">plus_attr_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/machine-learning/'>Machine Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/sklearn/" class="post-tag no-text-decoration" >sklearn</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine-learning</a> <a href="/tags/naive-bayes/" class="post-tag no-text-decoration" >naive-bayes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Naive+Bayes+Classification+-+Chase+Robertson&url=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fnaive-bayes%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Naive+Bayes+Classification+-+Chase+Robertson&u=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fnaive-bayes%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fnaive-bayes%2F&text=Naive+Bayes+Classification+-+Chase+Robertson" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fnaive-bayes%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/rgraphics/">Data Visualisation in base R</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/machine-learning/">machine-learning</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/r/">R</a> <a class="post-tag" href="/tags/sklearn/">sklearn</a> <a class="post-tag" href="/tags/graphics/">graphics</a> <a class="post-tag" href="/tags/visualisation/">visualisation</a> <a class="post-tag" href="/tags/beautifulsoup/">beautifulsoup</a> <a class="post-tag" href="/tags/decision-tree/">decision-tree</a> <a class="post-tag" href="/tags/forecasting/">forecasting</a> <a class="post-tag" href="/tags/ggplot/">ggplot</a></div></div></div><script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/decision-tree/"><div class="card-body"> <em class="small" data-ts="1651752000" data-df="ll" > 6 May 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Decision Tree Practice</h3><div class="text-muted small"><p> In this post, I compare 3 decision tree models pruned with different techniques. Analysis is conducted using 3 separate datasets to show how tree depth interacts with the dimensions of the dataset....</p></div></div></a></div><div class="card"> <a href="/posts/svm/"><div class="card-body"> <em class="small" data-ts="1655640000" data-df="ll" > 20 Jun 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Support Vector Machines</h3><div class="text-muted small"><p> In this assignment for a machine learning course, I generate synthetic data and explore how the underlying patterns affect SVM tuning parameters. DS1 Design a new dataset DS1 with at least 50 p...</p></div></div></a></div><div class="card"> <a href="/posts/ml-reflections/"><div class="card-body"> <em class="small" data-ts="1656504000" data-df="ll" > 30 Jun 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reflections on ML</h3><div class="text-muted small"><p> Latent thoughts and specific review regarding an introductory machine learning course taken at the University of Auckland. My Prior Since my first introduction to computers and computer science, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/decision-tree/" class="btn btn-outline-primary" prompt="Older"><p>Decision Tree Practice</p></a> <a href="/posts/rgraphics/" class="btn btn-outline-primary" prompt="Newer"><p>Data Visualisation in base R</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://twitter.com/chase__rob">Chase Robertson</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/machine-learning/">machine-learning</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/r/">R</a> <a class="post-tag" href="/tags/sklearn/">sklearn</a> <a class="post-tag" href="/tags/graphics/">graphics</a> <a class="post-tag" href="/tags/visualisation/">visualisation</a> <a class="post-tag" href="/tags/beautifulsoup/">beautifulsoup</a> <a class="post-tag" href="/tags/decision-tree/">decision-tree</a> <a class="post-tag" href="/tags/forecasting/">forecasting</a> <a class="post-tag" href="/tags/ggplot/">ggplot</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="/assets/lib/simple-jekyll-search-1.10.0/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="/assets/lib/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script> <script src="/assets/lib/lozad-1.16.0/lozad.min.js"></script> <script src="/assets/lib/clipboard-2.0.9/clipboard.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/dayjs.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/locale/en.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/plugin/relativeTime.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/lib/bootstrap-4.6.1/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
