<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="en-nz"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Decision Tree Practice" /><meta property="og:locale" content="en" /><meta name="description" content="In this post, I compare 3 decision tree models pruned with different techniques. Analysis is conducted using 3 separate datasets to show how tree depth interacts with the dimensions of the dataset." /><meta property="og:description" content="In this post, I compare 3 decision tree models pruned with different techniques. Analysis is conducted using 3 separate datasets to show how tree depth interacts with the dimensions of the dataset." /><link rel="canonical" href="https://chaserobertson.github.io/posts/decision-tree/" /><meta property="og:url" content="https://chaserobertson.github.io/posts/decision-tree/" /><meta property="og:site_name" content="Chase Robertson" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-06T00:00:00+12:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Decision Tree Practice" /><meta name="twitter:site" content="@chase__rob" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-06T00:00:00+12:00","datePublished":"2022-05-06T00:00:00+12:00","description":"In this post, I compare 3 decision tree models pruned with different techniques. Analysis is conducted using 3 separate datasets to show how tree depth interacts with the dimensions of the dataset.","headline":"Decision Tree Practice","mainEntityOfPage":{"@type":"WebPage","@id":"https://chaserobertson.github.io/posts/decision-tree/"},"url":"https://chaserobertson.github.io/posts/decision-tree/"}</script><title>Decision Tree Practice | Chase Robertson</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Chase Robertson"><meta name="application-name" content="Chase Robertson"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/lib/fonts/main.css"><link rel="stylesheet" href="/assets/lib/bootstrap-4.6.1/bootstrap.min.css"><link rel="stylesheet" href="/assets/lib/fontawesome-free-5.15.4/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/magnific-popup-1.1.0/magnific-popup.css"> <script src="/assets/lib/jquery-3.6.0/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/me.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Chase Robertson</a></div><div class="site-subtitle font-italic">Data Scientist</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/Thesis/" class="nav-link"> <i class="fa-fw fas fa-bolt ml-xl-3 mr-xl-3 unloaded"></i> <span>THESIS</span> </a><li class="nav-item"> <a href="/Resume/" class="nav-link"> <i class="fa-fw fas fa-user ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a><li class="nav-item"> <a href="/CV/" class="nav-link"> <i class="fa-fw fas fa-address-card ml-xl-3 mr-xl-3 unloaded"></i> <span>CV</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/certifications/" class="nav-link"> <i class="fa-fw fas fa-certificate ml-xl-3 mr-xl-3 unloaded"></i> <span>CERTIFICATIONS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/chaserobertson" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/chase__rob" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['chaserobertson208','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/chase-robertson" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Decision Tree Practice</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><h1 data-toc-skip>Decision Tree Practice</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1651752000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> 6 May 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/chase__rob">Chase Robertson</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2649 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><p>In this post, I compare 3 decision tree models pruned with different techniques. Analysis is conducted using 3 separate datasets to show how tree depth interacts with the dimensions of the dataset.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">pd</span><span class="p">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'mode.chained_assignment'</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
<span class="n">PATH_ROOT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="n">RANDOM_STATE</span> <span class="o">=</span> <span class="mi">123456</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
</pre></table></code></div></div><h1 id="task-1---data-preprocessing">Task 1 - Data Preprocessing</h1><h2 id="code-and-results"><span class="mr-2">Code and Results</span><a href="#code-and-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="preprocessing---arrhythmiacsv"><span class="mr-2">Preprocessing - <code class="language-plaintext highlighter-rouge"><span class="mr-2">arrhythmia.csv</code></span><a href="#preprocessing---arrhythmiacsv" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">heart</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'arrhythmia.csv'</span><span class="p">),</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s">'?'</span><span class="p">)</span>
<span class="n">heart_nulls</span> <span class="o">=</span> <span class="n">heart</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Raw arrhythmia data shape and # of nulls'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">heart</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">heart_nulls</span><span class="p">[</span><span class="n">heart_nulls</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">heart2</span> <span class="o">=</span> <span class="n">heart</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'J'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># --- separate training and test sets
</span><span class="n">heart_x</span> <span class="o">=</span> <span class="n">heart2</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'class'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">heart_y</span> <span class="o">=</span> <span class="n">heart2</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s">'class'</span><span class="p">]</span>
<span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_test_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">h_test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">heart_x</span><span class="p">,</span> <span class="n">heart_y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>

<span class="c1"># Interpolate training and testing data separately
</span><span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_test_x</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'linear'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">df_nulls</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="o">+</span><span class="s">'Preprocessed data shape and # of nulls:'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">df_nulls</span><span class="p">[</span><span class="n">df_nulls</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>Raw arrhythmia data shape and # of nulls
(452, 280)
T              8
P             22
QRST           1
J            376
heartrate      1
dtype: int64

Preprocessed data shape and # of nulls:
(361, 278)
Series([], dtype: int64)

Preprocessed data shape and # of nulls:
(91, 278)
Series([], dtype: int64)
</pre></table></code></div></div><h3 id="preprocessing---bcpcsv"><span class="mr-2">Preprocessing - <code class="language-plaintext highlighter-rouge"><span class="mr-2">BCP.csv</code></span><a href="#preprocessing---bcpcsv" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">bcp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'BCP.csv'</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">bcp_nulls</span> <span class="o">=</span> <span class="n">bcp</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">bcp</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">bcp_nulls</span><span class="p">[</span><span class="n">bcp_nulls</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">bcp</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>(683, 11)
Series([], dtype: int64)
Index(['Sample code number', 'Clump Thickness', 'Uniformity of Cell Size',
       'Uniformity of Cell Shape', 'Marginal Adhesion',
       'Single Epithelial Cell Size', 'Bare Nuclei', 'Bland Chromatin',
       'Normal Nucleoli', 'Mitoses', 'Class'],
      dtype='object')
</pre></table></code></div></div><h3 id="preprocessing---website-phishingcsv"><span class="mr-2">Preprocessing - <code class="language-plaintext highlighter-rouge"><span class="mr-2">website-phishing.csv</code></span><a href="#preprocessing---website-phishingcsv" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">website</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_ROOT</span><span class="p">,</span> <span class="s">'website-phishing.csv'</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">website_nulls</span> <span class="o">=</span> <span class="n">website</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">website</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">website_nulls</span><span class="p">[</span><span class="n">website_nulls</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">website</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">website</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">website</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>(11055, 31)
Series([], dtype: int64)
Index(['having_IP_Address', 'URL_Length', 'Shortining_Service',
       'having_At_Symbol', 'double_slash_redirecting', 'Prefix_Suffix',
       'having_Sub_Domain', 'SSLfinal_State', 'Domain_registeration_length',
       'Favicon', 'port', 'HTTPS_token', 'Request_URL', 'URL_of_Anchor',
       'Links_in_tags', 'SFH', 'Submitting_to_email', 'Abnormal_URL',
       'Redirect', 'on_mouseover', 'RightClick', 'popUpWidnow', 'Iframe',
       'age_of_domain', 'DNSRecord', 'web_traffic', 'Page_Rank',
       'Google_Index', 'Links_pointing_to_page', 'Statistical_report',
       'Class'],
      dtype='object')
</pre></table></code></div></div><h2 id="discussion"><span class="mr-2">Discussion</span><a href="#discussion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">arrhythmia</code><br /> I opened the csv data source in a text editor to get an idea of the raw data before attempting an import. Each column looked to be numeric, but I noticed some <code class="language-plaintext highlighter-rouge">?</code> characters likely meant to denote missing values. I imported specifying the <code class="language-plaintext highlighter-rouge">na_values</code> argument to capture those question marks as missing values, and the <code class="language-plaintext highlighter-rouge">skipinitialspace</code> argument to eliminate the leading space in each column header. I then retrieved which attributes were missing, and how many values each of those attributes were missing. The <code class="language-plaintext highlighter-rouge">J</code> attribute was missing from the vast majority of rows, so it seemed best to simply drop that attribute entirely, as it most likely would not provide our models with any information. I judged it best to linear-interpolate the other missing values, as interpolated values would be more informative for the models than values from other imputation methods. This decision could be revisited after models are built, to confirm that interpolated values are indeed more informative than another imputation method. It did require, however, that I separate the data into testing and training sets before imputing, in order not to have information leak between training and testing data. Because the dataset is so small, it would actually be better to impute 5 separate folds of data and use those to cross-validate performance. I haven’t done so in the interest of avoiding the refactoring time.</p><p><code class="language-plaintext highlighter-rouge">BCP</code><br /> Visually scanning the raw CSV suggested that each attribute’s values were integers, so missing values could be found by specifying data type on import and checking for type conversion failures. No nulls were found after conversion to np.int64, so there were no missing values in the BCP dataset.</p><p><code class="language-plaintext highlighter-rouge">website-phishing</code><br /> On visual inspection, all values seemed to be integers in the range <code class="language-plaintext highlighter-rouge">-1,0,1</code>. Converting to <code class="language-plaintext highlighter-rouge">np.int64</code> and searching for nulls should flush out any missing values, assuming missing values were not represented by an integer in the range <code class="language-plaintext highlighter-rouge">-1,0,1</code>. No missing values were found in this dataset under that assumption. Some column names in this dataset included leading and trailing whitespace, so a simple strip and replace was conducted to eliminate that whitespace.</p><h1 id="task-2---model-implementation">Task 2 - Model Implementation</h1><h2 id="utility-functions"><span class="mr-2">Utility Functions</span><a href="#utility-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>


<span class="k">def</span> <span class="nf">Tree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">depth_range</span><span class="o">=</span><span class="p">[],</span> <span class="n">max_depth</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    
    <span class="c1"># if given a range of depths, cross-validate which is best
</span>    <span class="k">if</span> <span class="n">depth_range</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">temp_model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s">'entropy'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="s">'max_depth'</span><span class="p">:</span> <span class="n">depth_range</span><span class="p">}]</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">temp_model</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="n">cv</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        
        <span class="n">best_depth</span> <span class="o">=</span> <span class="n">cv</span><span class="p">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s">'max_depth'</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">best_depth</span> <span class="o">=</span> <span class="n">max_depth</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s">'entropy'</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">best_depth</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
    
    
<span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="n">train_score</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">test_score</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">'(depth {:})</span><span class="se">\t</span><span class="s">train: {:.2f}%</span><span class="se">\t</span><span class="s">test: {:.2f}%'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">tree_</span><span class="p">.</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">train_score</span><span class="p">,</span> <span class="n">test_score</span><span class="p">))</span>
    
    
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>    
</pre></table></code></div></div><h2 id="code-and-results-1"><span class="mr-2">Code and Results</span><a href="#code-and-results-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="arrhythmiacsv"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">arrhythmia.csv</code></span><a href="#arrhythmiacsv" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">models</span><span class="p">[</span><span class="s">'Arr Stump'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Arr Stump'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_test_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">h_test_y</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'Arr Unpruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Arr Unpruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_test_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">h_test_y</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'Arr Pruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">depth_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Arr Pruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_test_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">h_test_y</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Arr Stump (depth 1)	train: 55.96%	test: 60.44%
Arr Unpruned (depth 10)	train: 100.00%	test: 72.53%


/Users/chase/opt/anaconda3/lib/python3.9/site-packages/sklearn/model_selection/_split.py:666: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(("The least populated class in y has only %d"


Arr Pruned (depth 5)	train: 81.72%	test: 71.43%
</pre></table></code></div></div><h3 id="bcpcsv"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">BCP.csv</code></span><a href="#bcpcsv" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">bcp</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Class'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">bcp</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s">'Class'</span><span class="p">]</span>
<span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_X_test</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">bcp_y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>


<span class="c1"># Fit models and display accuracy scores
</span><span class="n">models</span><span class="p">[</span><span class="s">'BCP Stump'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'BCP Stump'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_X_test</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">bcp_y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'BCP Unpruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'BCP Unpruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_X_test</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">bcp_y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'BCP Pruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">depth_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'BCP Pruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_X_test</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">bcp_y_test</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>BCP Stump (depth 1)	train: 92.12%	test: 94.89%
BCP Unpruned (depth 7)	train: 100.00%	test: 96.35%
BCP Pruned (depth 6)	train: 99.27%	test: 96.35%
</pre></table></code></div></div><h3 id="website-phishingcsv"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">website-phishing.csv</code></span><a href="#website-phishingcsv" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">website</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Class'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">website</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s">'Class'</span><span class="p">]</span>
<span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_X_test</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">web_y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>


<span class="c1"># Fit models and display accuracy scores
</span><span class="n">models</span><span class="p">[</span><span class="s">'Web Stump'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Web Stump'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_X_test</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">web_y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'Web Unpruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Web Unpruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_X_test</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">web_y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'Web Pruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">depth_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Web Pruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_X_test</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">web_y_test</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Web Stump (depth 1)	train: 88.67%	test: 89.78%
Web Unpruned (depth 24)	train: 99.06%	test: 96.43%
Web Pruned (depth 19)	train: 98.69%	test: 96.65%
</pre></table></code></div></div><h2 id="discussion-1"><span class="mr-2">Discussion</span><a href="#discussion-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I chose to use pre-pruning for the pruned model, because the decision stumps were already quite accurate, and it was very simple to implement a hard limit on the tree depth. However, pruning in this way did not greatly improve test performance over the unpruned models.</p><h1 id="task-3---hyperparameter-tuning">Task 3 - Hyperparameter Tuning</h1><h2 id="discussion-2"><span class="mr-2">Discussion</span><a href="#discussion-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I chose to use exhaustive grid search with cross-validation to select my pre-pruning hyperparameter. This method iterates through each combination of hyperparameters in the specified range of options. For each hyperparameter option, the training data is split into 5 different training/validation folds. The model is separately fit and tested on each training/validation set combination (fold), and the performance scores of each fold are averaged out to get a single performance score for the hyperparameter option being used. By repeating this process for each hyperparameter option, the “best” hyperparameter for the data can be selected with minimal bias. Grid search was selected over random search because only one hyperparameter needed tuning, so the two operations would likely be equivalent in runtime and result.</p><p>The <code class="language-plaintext highlighter-rouge">arrhythmia</code> dataset was optimised at a very shallow depth for the number of features included. I attributed this to an overabundance of features in the dataset relative to the number of examples. This assumption is strengthened by the very low test performance of all attempted models. There is simply not enough data to discover many relationships between the hundreds of features and the class.</p><p>The <code class="language-plaintext highlighter-rouge">bcp</code> dataset was optimised near its maximum possible depth: nearly all of the features were at least somewhat informative. However, the high test performance of the decision stump suggests that only one feature contributed the vast majority of information necessary to make an accurate prediction.</p><p>The <code class="language-plaintext highlighter-rouge">website</code> dataset turned out to be similar to <code class="language-plaintext highlighter-rouge">bcp</code>, though with many more features and many more examples. The decision stump scored quite well, with the unpruned and pre-pruned models using a high number of features to gain some small amount of new information.</p><h1 id="task-4---comparing-models">Task 4 - Comparing Models</h1><h2 id="code-and-results-2"><span class="mr-2">Code and Results</span><a href="#code-and-results-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">mlxtend.evaluate</span> <span class="kn">import</span> <span class="n">paired_ttest_5x2cv</span>

<span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'Arr Stump'</span><span class="p">,</span> <span class="s">'Arr Unpruned'</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'Arr Unpruned'</span><span class="p">,</span> <span class="s">'Arr Pruned'</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">m1</span> <span class="o">==</span> <span class="n">m2</span><span class="p">:</span> <span class="c1"># do not compare the unpruned model to itself
</span>            <span class="k">continue</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">paired_ttest_5x2cv</span><span class="p">(</span><span class="n">estimator1</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">estimator2</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m2</span><span class="p">],</span>
                                  <span class="n">X</span><span class="o">=</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">h_train_y</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">&lt;--Significant difference"</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s">""</span>
        <span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="s">'vs'</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s">'</span><span class="se">\t</span><span class="s">p value: %.3f'</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>

<span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'BCP Stump'</span><span class="p">,</span> <span class="s">'BCP Unpruned'</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'BCP Unpruned'</span><span class="p">,</span> <span class="s">'BCP Pruned'</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">m1</span> <span class="o">==</span> <span class="n">m2</span><span class="p">:</span> <span class="c1"># do not compare the unpruned model to itself
</span>            <span class="k">continue</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">paired_ttest_5x2cv</span><span class="p">(</span><span class="n">estimator1</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">estimator2</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m2</span><span class="p">],</span>
                                  <span class="n">X</span><span class="o">=</span><span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">&lt;--Significant difference"</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s">""</span>
        <span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="s">'vs'</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s">'</span><span class="se">\t</span><span class="s">p value: %.3f'</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>

<span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'Web Stump'</span><span class="p">,</span> <span class="s">'Web Unpruned'</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'Web Unpruned'</span><span class="p">,</span> <span class="s">'Web Pruned'</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">m1</span> <span class="o">==</span> <span class="n">m2</span><span class="p">:</span> <span class="c1"># do not compare the unpruned model to itself
</span>            <span class="k">continue</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">paired_ttest_5x2cv</span><span class="p">(</span><span class="n">estimator1</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">estimator2</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m2</span><span class="p">],</span>
                                  <span class="n">X</span><span class="o">=</span><span class="n">web_X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">web_y_train</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">&lt;--Significant difference"</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s">""</span>
        <span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="s">'vs'</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s">'</span><span class="se">\t</span><span class="s">p value: %.3f'</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Arr Stump vs Arr Unpruned 	p value: 0.199 
Arr Stump vs Arr Pruned 	p value: 0.231 
Arr Unpruned vs Arr Pruned 	p value: 0.707 

BCP Stump vs BCP Unpruned 	p value: 0.012 	&lt;--Significant difference
BCP Stump vs BCP Pruned 	p value: 0.011 	&lt;--Significant difference
BCP Unpruned vs BCP Pruned 	p value: 0.384 

Web Stump vs Web Unpruned 	p value: 0.000 	&lt;--Significant difference
Web Stump vs Web Pruned 	p value: 0.000 	&lt;--Significant difference
Web Unpruned vs Web Pruned 	p value: 0.597 
</pre></table></code></div></div><h2 id="discussion-3"><span class="mr-2">Discussion</span><a href="#discussion-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Significance tests were conducted using a <em>5x2cv</em> paired test. For 5 iterations, the data was split into two 50% halves, with one half used to fit the two specified models, and other half used to evaluate each of the models. The models were then fit and tested again, but with the two halves of data swapped. The difference in prediction accuracy between the two models for each of the two train/test phases was computed, and a mean and variance for the set of two differences is computed. When all 5 iterations finished, the very first accuracy difference computed was used, along with the variance of the distribution of mean differences in accuracy, to compute the <em>t</em> statistic. The <em>t</em> statistic given 5 degrees of freedom yielded the <em>p</em> value, illuminating the statistical significance of the differences in prediction accuracy between models. Any reported <em>p</em> values below the significance threshold of 0.05 indicate a statistically significant difference in prediction accuracy.</p><p>The differences in prediction accuracy between all three <code class="language-plaintext highlighter-rouge">arrhythmia</code> models were not statistically significant, because all three models performed so poorly. Likewise, a statistically significant difference between any unpruned vs pruned models trained on any dataset was not found, likely because the pre-pruning method was not able to remove any nodes without negatively affecting validation scores.</p><p>There was a statistically significant difference in prediction accuracy between the decision stump model and the other two models, for both the <code class="language-plaintext highlighter-rouge">BCP</code> and <code class="language-plaintext highlighter-rouge">website</code> datasets. The decision stump was able to capture the most important feature in each dataset, and perform quite well as a result, but continuing to build the tree with more features made a significant difference on prediction accuracy.</p><h1 id="task-5---different-pruning-strategy">Task 5 - Different Pruning Strategy</h1><h2 id="utility-functions-1"><span class="mr-2">Utility Functions</span><a href="#utility-functions-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>

<span class="k">def</span> <span class="nf">CostPrunedTree</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
    <span class="n">temp_model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s">'entropy'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
    
    <span class="n">path</span> <span class="o">=</span> <span class="n">temp_model</span><span class="p">.</span><span class="n">cost_complexity_pruning_path</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">path</span><span class="p">.</span><span class="n">ccp_alphas</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s">'ccp_alpha'</span><span class="p">:</span> <span class="n">alphas</span><span class="p">}</span>
    <span class="p">]</span>
    <span class="n">n_iter</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alphas</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
    
    <span class="n">clf</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">temp_model</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
    <span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">best_alpha</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s">'ccp_alpha'</span><span class="p">]</span>
 
    <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s">'entropy'</span><span class="p">,</span> <span class="n">ccp_alpha</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></table></code></div></div><h2 id="code-and-results-3"><span class="mr-2">Code and Results</span><a href="#code-and-results-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">models</span><span class="p">[</span><span class="s">'Arr CCPruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">CostPrunedTree</span><span class="p">(</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Arr CCPruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">h_train_x</span><span class="p">,</span> <span class="n">h_test_x</span><span class="p">,</span> <span class="n">h_train_y</span><span class="p">,</span> <span class="n">h_test_y</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'BCP CCPruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">CostPrunedTree</span><span class="p">(</span><span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'BCP CCPruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">bcp_X_test</span><span class="p">,</span> <span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">bcp_y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s">'Web CCPruned'</span><span class="p">]</span> <span class="o">=</span> <span class="n">CostPrunedTree</span><span class="p">(</span><span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="s">'Web CCPruned'</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">web_X_train</span><span class="p">,</span> <span class="n">web_X_test</span><span class="p">,</span> <span class="n">web_y_train</span><span class="p">,</span> <span class="n">web_y_test</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>/Users/chase/opt/anaconda3/lib/python3.9/site-packages/sklearn/model_selection/_split.py:666: UserWarning: The least populated class in y has only 2 members, which is less than n_splits=5.
  warnings.warn(("The least populated class in y has only %d"


Arr CCPruned (depth 8)	train: 83.10%	test: 72.53%
BCP CCPruned (depth 7)	train: 99.45%	test: 97.08%
Web CCPruned (depth 23)	train: 98.88%	test: 96.56%
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1"># Arrhythmia pre-pruning vs cost-complexity pruning
</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="s">'Arr Pruned'</span><span class="p">,</span> <span class="s">'Arr CCPruned'</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">paired_ttest_5x2cv</span><span class="p">(</span><span class="n">estimator1</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">estimator2</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m2</span><span class="p">],</span>
                          <span class="n">X</span><span class="o">=</span><span class="n">h_train_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">h_train_y</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">&lt;--Significant difference"</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s">""</span>
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="s">'vs'</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s">'</span><span class="se">\t</span><span class="s">p value: %.3f'</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>


<span class="c1"># BCP pre-pruning vs cost-complexity pruning
</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="s">'BCP Pruned'</span><span class="p">,</span> <span class="s">'BCP CCPruned'</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">paired_ttest_5x2cv</span><span class="p">(</span><span class="n">estimator1</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">estimator2</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m2</span><span class="p">],</span>
                          <span class="n">X</span><span class="o">=</span><span class="n">bcp_X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bcp_y_train</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">&lt;--Significant difference"</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s">""</span>
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="s">'vs'</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s">'</span><span class="se">\t</span><span class="s">p value: %.3f'</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>


<span class="c1"># website-phishing pre-pruning vs cost-complexity pruning
</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="s">'Web Pruned'</span><span class="p">,</span> <span class="s">'Web CCPruned'</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">paired_ttest_5x2cv</span><span class="p">(</span><span class="n">estimator1</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">estimator2</span><span class="o">=</span><span class="n">models</span><span class="p">[</span><span class="n">m2</span><span class="p">],</span>
                          <span class="n">X</span><span class="o">=</span><span class="n">web_X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">web_y_train</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">&lt;--Significant difference"</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s">""</span>
<span class="k">print</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="s">'vs'</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="s">'</span><span class="se">\t</span><span class="s">p value: %.3f'</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Arr Pruned vs Arr CCPruned 	p value: 0.863 
BCP Pruned vs BCP CCPruned 	p value: 0.384 
Web Pruned vs Web CCPruned 	p value: 0.573 
</pre></table></code></div></div><h2 id="discussion-4"><span class="mr-2">Discussion</span><a href="#discussion-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The new pruning strategy executed was cost complexity pruning, with the complexity parameter (alpha) determined by random search cross-validation over at least ten possible values. Alpha acts like a misclassification threshold: nodes whose decisions cause misclassification at a rate higher than alpha are pruned, in order of severity of misclassification. This is done by calculating the cost complexity of each node, pruning the node with maximum cost complexity, and repeating the process until every node’s cost complexity is greater than alpha. Random cross-validation is used to select alpha because exhaustive search would take too long, and a random sample of all possible alphas of the right size should find an alpha that is good enough.</p><p>Cost-complexity pruning did not yield significantly better results than simply restricting the depth of the decision tree. This is confirmed with paired t-test cv accuracy comparisons and their resulting high p-values. The insignificant improvement over pre-pruning likely comes from the datasets themselves: they are either too complex for a decision tree to be very accurate (<code class="language-plaintext highlighter-rouge">arrhythmia</code>), or they are so easily predictable by a decision tree that it does not matter much that the tree is pruned any certain way, or pruned at all (<code class="language-plaintext highlighter-rouge">BCP</code> and <code class="language-plaintext highlighter-rouge">website</code>).</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/machine-learning/'>Machine Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/sklearn/" class="post-tag no-text-decoration" >sklearn</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine-learning</a> <a href="/tags/decision-tree/" class="post-tag no-text-decoration" >decision-tree</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Decision+Tree+Practice+-+Chase+Robertson&url=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fdecision-tree%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Decision+Tree+Practice+-+Chase+Robertson&u=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fdecision-tree%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fdecision-tree%2F&text=Decision+Tree+Practice+-+Chase+Robertson" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fchaserobertson.github.io%2Fposts%2Fdecision-tree%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/rgraphics/">Data Visualisation in base R</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/machine-learning/">machine-learning</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/r/">R</a> <a class="post-tag" href="/tags/sklearn/">sklearn</a> <a class="post-tag" href="/tags/graphics/">graphics</a> <a class="post-tag" href="/tags/visualisation/">visualisation</a> <a class="post-tag" href="/tags/beautifulsoup/">beautifulsoup</a> <a class="post-tag" href="/tags/decision-tree/">decision-tree</a> <a class="post-tag" href="/tags/forecasting/">forecasting</a> <a class="post-tag" href="/tags/ggplot/">ggplot</a></div></div></div><script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/naive-bayes/"><div class="card-body"> <em class="small" data-ts="1651752000" data-df="ll" > 6 May 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Naive Bayes Classification</h3><div class="text-muted small"><p> This post details the development process for my submission to the Point-of-Interest Categorization competition on Kaggle. Motivation In order to match the benchmark model performance initially, s...</p></div></div></a></div><div class="card"> <a href="/posts/svm/"><div class="card-body"> <em class="small" data-ts="1655640000" data-df="ll" > 20 Jun 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Support Vector Machines</h3><div class="text-muted small"><p> In this assignment for a machine learning course, I generate synthetic data and explore how the underlying patterns affect SVM tuning parameters. DS1 Design a new dataset DS1 with at least 50 p...</p></div></div></a></div><div class="card"> <a href="/posts/ml-reflections/"><div class="card-body"> <em class="small" data-ts="1656504000" data-df="ll" > 30 Jun 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reflections on ML</h3><div class="text-muted small"><p> Latent thoughts and specific review regarding an introductory machine learning course taken at the University of Auckland. My Prior Since my first introduction to computers and computer science, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/welcome/" class="btn btn-outline-primary" prompt="Older"><p>Welcome!</p></a> <a href="/posts/naive-bayes/" class="btn btn-outline-primary" prompt="Newer"><p>Naive Bayes Classification</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/chase__rob">Chase Robertson</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/machine-learning/">machine-learning</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/r/">R</a> <a class="post-tag" href="/tags/sklearn/">sklearn</a> <a class="post-tag" href="/tags/graphics/">graphics</a> <a class="post-tag" href="/tags/visualisation/">visualisation</a> <a class="post-tag" href="/tags/beautifulsoup/">beautifulsoup</a> <a class="post-tag" href="/tags/decision-tree/">decision-tree</a> <a class="post-tag" href="/tags/forecasting/">forecasting</a> <a class="post-tag" href="/tags/ggplot/">ggplot</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="/assets/lib/simple-jekyll-search-1.10.0/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="/assets/lib/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script> <script src="/assets/lib/lozad-1.16.0/lozad.min.js"></script> <script src="/assets/lib/clipboard-2.0.9/clipboard.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/dayjs.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/locale/en.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/plugin/relativeTime.min.js"></script> <script src="/assets/lib/dayjs-1.10.7/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/lib/bootstrap-4.6.1/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
